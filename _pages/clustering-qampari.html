---
layout: single
title: "Clustering (QAMPARI)"
permalink: /clustering-qampari/
noindex: true
---

<div class="clustering-page">
  <h1>Clustering Results</h1>
  <div id="results-container">
    <!-- Results will be populated here -->
  </div>
</div>

<style>
  .clustering-page {
    overflow-x: auto;
  }
  .question-container {
    background-color: white;
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    min-width: fit-content;
  }
  .question-title {
    color: #2c3e50;
    border-bottom: 2px solid #3498db;
    padding-bottom: 10px;
    margin-bottom: 20px;
  }
  .question-text {
    background-color: #f8f9fa;
    padding: 15px;
    border-radius: 6px;
    margin-bottom: 20px;
    font-size: 1.1em;
    color: #2c3e50;
    border-left: 4px solid #3498db;
  }
  .clusters-row {
    display: flex;
    flex-wrap: nowrap;
    gap: 20px;
    margin-bottom: 20px;
    overflow-x: auto;
    padding-bottom: 10px;
  }
  .cluster-container {
    background-color: #f8f9fa;
    border-radius: 6px;
    padding: 15px;
    flex: 0 0 300px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  }
  .cluster-header {
    color: #2980b9;
    margin-bottom: 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .cluster-size {
    background-color: #3498db;
    color: white;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 0.9em;
  }
  .document-item {
    background-color: white;
    padding: 10px;
    margin: 5px 0;
    border-radius: 4px;
    border-left: 4px solid #3498db;
  }
  .document-item.gold {
    border-left: 4px solid #f1c40f;
  }
  .document-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 5px;
  }
  .document-rank {
    color: #2c3e50;
    font-weight: bold;
  }
  .gold-status {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 0.9em;
    font-weight: bold;
  }
  .gold-status.true {
    background-color: #fff3cd;
    color: #856404;
  }
  .gold-status.false {
    background-color: #f8f9fa;
    color: #6c757d;
  }
  .document-text {
    margin-top: 5px;
    font-size: 0.95em;
    color: #333;
  }
  .clusters-row::-webkit-scrollbar { height: 8px; }
  .clusters-row::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 4px; }
  .clusters-row::-webkit-scrollbar-thumb { background: #888; border-radius: 4px; }
  .clusters-row::-webkit-scrollbar-thumb:hover { background: #555; }
</style>

<script id="clustering-data" type="application/json">{{ site.data.clustering_results_qampari | jsonify }}</script>

<script>
  (function() {
    var raw = document.getElementById('clustering-data');
    var results = [];
    try {
      results = JSON.parse(raw.textContent || '[]');
    } catch (e) {
      results = [];
    }

    function createQuestionContainer(questionIdx, questionData) {
      var container = document.createElement('div');
      container.className = 'question-container';

      var title = document.createElement('h2');
      title.className = 'question-title';
      title.textContent = 'Question ' + (questionIdx + 1);
      container.appendChild(title);

      var questionText = document.createElement('div');
      questionText.className = 'question-text';
      questionText.textContent = questionData.question;
      container.appendChild(questionText);

      var clustersRow = document.createElement('div');
      clustersRow.className = 'clusters-row';

      questionData.clusters.forEach(function(cluster, clusterIdx) {
        var clusterDiv = document.createElement('div');
        clusterDiv.className = 'cluster-container';

        var clusterHeader = document.createElement('h3');
        clusterHeader.className = 'cluster-header';
        clusterHeader.innerHTML = '<span>Cluster ' + (clusterIdx + 1) + '</span>' +
          '<span class="cluster-size">' + cluster.size + ' docs</span>';
        clusterDiv.appendChild(clusterHeader);

        var docsList = document.createElement('div');
        docsList.className = 'documents-list';

        cluster.topDocs.forEach(function(doc, idx) {
          var docItem = document.createElement('div');
          docItem.className = 'document-item ' + (doc.is_gold ? 'gold' : '');
          var isGold = !!doc.is_gold;
          var displayRank = (doc.ranking !== undefined && doc.ranking !== null) ? (doc.ranking + 1) : (idx + 1);
          docItem.innerHTML =
            '<div class="document-header">' +
              '<span class="document-rank">Rank: ' + displayRank + '</span>' +
              '<span class="gold-status ' + isGold + '">' + (isGold ? 'â˜… Gold Answer' : 'Non-Gold Answer') + '</span>' +
            '</div>' +
            '<div class="document-text">' + (doc.text || '') + '</div>';
          docsList.appendChild(docItem);
        });

        clusterDiv.appendChild(docsList);
        clustersRow.appendChild(clusterDiv);
      });

      container.appendChild(clustersRow);
      return container;
    }

    function displayResults(results) {
      var container = document.getElementById('results-container');
      if (!Array.isArray(results)) {
        container.innerHTML = '<p style="color: red;">No data found. Ensure _data/clustering_results_qampari.json exists and is valid JSON.</p>';
        return;
      }
      results.forEach(function(questionData, idx) {
        container.appendChild(createQuestionContainer(idx, questionData));
      });
    }

    displayResults(results);
  })();
</script> 